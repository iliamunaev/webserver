# Standard Web Server Configuration
# Root: /home/ilyam/42/webserver/www
# Features: Upload, CGI, Static files, Autoindex
# -----------------------------------------------------------------------------
server {
    # Identification and network configuration
    server_name webserv_standart
    listen 8081
    host 127.0.0.1
    root /home/ilyam/42/webserver/www
    index index.html
    client_max_body_size 10

    # Root location - serves the main page
    location / {
        allow_methods GET
        index index.html
        autoindex off
    }

    # Upload page - serves the upload form
    location /upload {
        allow_methods GET
        index upload.html
    }

    # File upload handler - handles POST requests to /uploads
    location /uploads {
        allow_methods POST DELETE
        upload_to /home/ilyam/42/webserver/www/uploads
        index upload_success.html
    }

    # Delete endpoint - for file deletion
    location /delete {
        allow_methods GET DELETE
        index delete.html
    }

    # CGI scripts endpoint - for dynamic content
    location /cgi-bin {
        allow_methods GET POST
        cgi_path /home/ilyam/42/webserver/www/cgi-bin
        cgi_ext .py .js
        index index.html
    }

    # Static files - images, CSS, JS
    location /imgs {
        allow_methods GET
        index nonexistent.html
        autoindex on
    }

    # Favicon
    location /favicon.ico {
        allow_methods GET
        index index.html
    }

    # API endpoint - for JSON/XML responses
    location /api {
        allow_methods GET POST
        index index.html
        autoindex off
    }

    # Admin area - restricted access
    location /admin {
        allow_methods GET
        index index.html
        autoindex off
    }

    # Error page configuration
    error_page 404 404.html

}

# -----------------------------------------------------------------------------
# TEST CASES:
#
# Basic functionality:
# - curl http://localhost:8080/           -> index.html
# - curl http://localhost:8080/upload     -> upload.html
# - curl http://localhost:8080/imgs       -> directory listing
# - curl http://localhost:8080/admin      -> index.html
#
# Upload functionality:
# - POST to http://localhost:8080/uploads -> upload file and redirect to success
# - DELETE to http://localhost:8080/uploads/filename -> delete uploaded file
#
# CGI functionality:
# - curl http://localhost:8080/cgi-bin/script.py -> execute Python script
#
# API functionality:
# - curl http://localhost:8080/api        -> API response
#
# This configuration provides a complete, standardized web server setup
# with all essential features properly configured.
# =============================================================================
